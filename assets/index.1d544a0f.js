import{b as M,u as S,r as F,b5 as l,m as w,a,F as f,j as e,B as h,D as O,N as x,bi as _,c0 as V}from"./index.008b4aaa.js";import{g as j}from"./ability.396a7c4c.js";import{b as P}from"./myApp.9c9cadf6.js";import{U as I}from"./UploadOutlined.478f0155.js";const T="_header_zn0qe_1",k="_title_zn0qe_6",G="_section_zn0qe_17",H="_guide_zn0qe_27",J="_step_zn0qe_36",K="_icon01_zn0qe_58",Q="_icon02_zn0qe_61",W="_icon03_zn0qe_64",X="_arrow_zn0qe_67",Y="_download_zn0qe_81",s={header:T,title:k,section:G,guide:H,step:J,"step-item":"_step-item_zn0qe_40","step-icon":"_step-icon_zn0qe_53",icon01:K,icon02:Q,icon03:W,arrow:X,download:Y},ae=()=>{const[E]=M(),A=S(),B=E.get("clientId"),m=Number(E.get("capabilityId")),[p,z]=F.exports.useState();(!B||!m)&&A(-1),F.exports.useEffect(()=>{(async()=>{const{data:u}=await j({id:m});!u||z(u)})()},[]);const[t]=l.useForm(),L={labelCol:{span:6},wrapperCol:{span:12},autoComplete:"off"},[v,N]=F.exports.useState(),[y,g]=F.exports.useState(),[D,$]=w.useMessage(),b=(u,o=1)=>{const{name:c}=u,r=c.substring(c.lastIndexOf(".")+1),i=["pdf"].includes(r);i||D.error(`\u4E0D\u652F\u6301\u4E0A\u4F20${r}\u683C\u5F0F\u6587\u4EF6`);const d=u.size/1024/1024<o;return d||w.error(`\u56FE\u7247\u6587\u4EF6\u5927\u5C0F<${o}MB`),i&&d||_.LIST_IGNORE};let n;const C=async(u,o)=>{const c=new FormData,{file:r}=u;c.append("file",r);try{const{data:i}=await V(c),{fileName:d,url:U}=i;n={uid:u.file.uid,name:d,status:"done",url:U}}catch(i){console.log("error",i),n={uid:u.file.uid,name:u.file.name,status:"error",url:""}}finally{o?g([n]):N([n]),t.setFieldValue(o?"applyLetter":"applyFile",n.url)}},q=u=>{u?(g(void 0),t.setFieldValue("applyLetter",void 0)):(N(void 0),t.setFieldValue("applyFile",void 0))},R=async()=>{try{await t.validateFields();const u={...t.getFieldsValue(),applyFileName:v[0].name,applyLetterName:y[0].name,capabilityId:m,clientId:B};await P(u),D.success({content:"\u63D0\u4EA4\u6210\u529F",onClose:()=>A(-1)})}catch(u){console.log(u)}};return a(f,{children:[$,a("div",{className:s.header,children:[a("div",{className:s.title,children:["\u4E0A\u4F20\u7533\u8BF7\u8868 - ",p==null?void 0:p.name]}),e(h,{type:"primary",onClick:R,children:"\u63D0\u4EA4"})]}),e(O,{}),a("div",{className:s.section,children:[e("div",{className:s.guide,children:"\u64CD\u4F5C\u6307\u5F15"}),a("div",{className:s.step,children:[a("div",{className:s["step-item"],children:[e("i",{className:`${s["step-icon"]} ${s.icon01}`}),"\u4E0B\u8F7D\u7533\u8BF7\u8868"]}),e("div",{className:s.arrow}),a("div",{className:s["step-item"],children:[e("i",{className:`${s["step-icon"]} ${s.icon02}`}),"\u7EBF\u4E0B\u5370\u7AE0"]}),e("div",{className:s.arrow}),a("div",{className:s["step-item"],children:[e("i",{className:`${s["step-icon"]} ${s.icon03}`}),"\u4E0A\u4F20\u626B\u63CF\u4EF6"]})]})]}),e("div",{className:s.section,children:a(l,{form:t,name:"uploadForm",...L,children:[e(l.Item,{label:"\u7533\u8BF7\u8868\u4E0B\u8F7D\uFF1A",children:a("div",{className:"flex",children:["\u300A\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u8868.pdf\u300B",a("div",{className:s.download,children:[e(x,{}),"\u4E0B\u8F7D"]})]})}),e(l.Item,{label:"\u7533\u8BF7\u51FD\u4E0B\u8F7D\uFF1A",children:a("div",{className:"flex",children:["\u300A\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u51FD.pdf\u300B",a("div",{className:s.download,children:[e(x,{}),"\u4E0B\u8F7D"]})]})}),e(l.Item,{name:"applyFile",label:"\uFF08\u9644\u5370\u7AE0\uFF09\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u8868\uFF1A",extra:a(f,{children:[e("p",{children:"\u652F\u6301\u6587\u4EF6\u683C\u5F0F\uFF1Apdf"}),e("p",{children:"\u652F\u6301\u6587\u4EF6\u5927\u5C0F\uFF1A1Mb"})]}),rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u7533\u8BF7\u8868"}],children:e(_,{maxCount:1,fileList:v,beforeUpload:u=>b(u),customRequest:u=>C(u,0),onRemove:()=>q(0),children:e(h,{icon:e(I,{}),children:"\u4E0A\u4F20\u6587\u4EF6"})})}),e(l.Item,{name:"applyLetter",label:"\uFF08\u9644\u5370\u7AE0\uFF09\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u51FD\uFF1A",extra:a(f,{children:[e("p",{children:"\u652F\u6301\u6587\u4EF6\u683C\u5F0F\uFF1Apdf"}),e("p",{children:"\u652F\u6301\u6587\u4EF6\u5927\u5C0F\uFF1A1Mb"})]}),rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u7533\u8BF7\u8868"}],children:e(_,{maxCount:1,fileList:y,beforeUpload:u=>b(u),customRequest:u=>C(u,1),onRemove:()=>q(1),children:e(h,{icon:e(I,{}),children:"\u4E0A\u4F20\u6587\u4EF6"})})})]})})]})};export{ae as default};
