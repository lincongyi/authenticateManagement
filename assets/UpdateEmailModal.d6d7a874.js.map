{"version":3,"file":"UpdateEmailModal.d6d7a874.js","sources":["../../src/pages/MyAccount/CompanySettings/components/UpdateEmailModal.tsx"],"sourcesContent":["import React from 'react'\r\nimport { Button, Form, Input, Modal, Space, message } from 'antd'\r\nimport { updateAdminEmail } from '@api/myAccount'\r\nimport EmailCaptcha from '@components/EmailCaptcha'\r\nimport { emailPattern } from '@utils/index'\r\n\r\nconst UpdateEmailModal = ({\r\n  open,\r\n  setOpen,\r\n  companyInfo,\r\n  callback\r\n}: {\r\n  open: boolean\r\n  setOpen: Function\r\n  companyInfo: TCompanyInfo\r\n  callback: Function\r\n}) => {\r\n  const [form] = Form.useForm()\r\n\r\n  /* eslint-disable no-template-curly-in-string */\r\n  const validateMessages = {\r\n    required: '请输入${label}'\r\n  }\r\n  /* eslint-disable no-template-curly-in-string */\r\n\r\n  const initialValues = {\r\n    adminEmail: companyInfo.adminEmail\r\n  }\r\n\r\n  /**\r\n   * 提交数据\r\n   */\r\n  const onFinish = async (values: any) => {\r\n    const { captcha, adminEmail } = values\r\n    await updateAdminEmail({\r\n      email: adminEmail,\r\n      captcha,\r\n      dabbyUserId: companyInfo.userId\r\n    })\r\n    callback(adminEmail)\r\n    onCancel()\r\n    message.success({ content: '成功修改邮箱！' })\r\n  }\r\n\r\n  const onFinishFailed = (errorInfo: any) => {\r\n    console.log('Failed:', errorInfo)\r\n  }\r\n\r\n  /**\r\n   * 取消\r\n   */\r\n  const onCancel = () => {\r\n    form.resetFields()\r\n    setOpen(false)\r\n  }\r\n\r\n  return (\r\n    <Modal title='修改管理员邮箱' open={open} footer={[]}>\r\n      <Form\r\n        form={form}\r\n        name='update'\r\n        labelCol={{ span: 6 }}\r\n        wrapperCol={{ span: 16 }}\r\n        onFinish={onFinish}\r\n        onFinishFailed={onFinishFailed}\r\n        validateMessages={validateMessages}\r\n        validateTrigger={['onBlur', 'onChange']}\r\n        initialValues={initialValues}\r\n        autoComplete='off'\r\n      >\r\n        <Form.Item\r\n          label='管理员邮箱'\r\n          name='adminEmail'\r\n          rules={[\r\n            { required: true },\r\n            {\r\n              validator (_, value) {\r\n                const pattern = emailPattern\r\n                if (!value || pattern.test(value)) {\r\n                  return Promise.resolve()\r\n                }\r\n                return Promise.reject(new Error('邮箱格式有误，请重新确认'))\r\n              },\r\n              validateTrigger: 'onBlur'\r\n            }\r\n          ]}\r\n        >\r\n          <Input maxLength={30} />\r\n        </Form.Item>\r\n        <Form.Item label='邮箱验证码' name='captcha' required>\r\n          <EmailCaptcha\r\n            form={form}\r\n            widthList={[180, 130]}\r\n            callback={(code: string) => form.setFieldValue('captcha', code)}\r\n            operation='更新单位信息'\r\n          />\r\n        </Form.Item>\r\n\r\n        <Form.Item wrapperCol={{ span: 22 }} style={{ textAlign: 'right' }}>\r\n          <Space>\r\n            <Button onClick={onCancel}>取消</Button>\r\n            <Button type='primary' htmlType='submit'>\r\n              确定\r\n            </Button>\r\n          </Space>\r\n        </Form.Item>\r\n      </Form>\r\n    </Modal>\r\n  )\r\n}\r\n\r\nexport default UpdateEmailModal\r\n"],"names":["UpdateEmailModal","open","setOpen","companyInfo","callback","form","Form","useForm","validateMessages","required","initialValues","adminEmail","onFinish","values","captcha","updateAdminEmail","email","dabbyUserId","userId","onCancel","message","success","content","onFinishFailed","errorInfo","log","resetFields","Modal","span","_jsx","validator","_","value","emailPattern","test","Promise","resolve","reject","Error","validateTrigger","Input","EmailCaptcha","code","setFieldValue","textAlign","Space","Button"],"mappings":"wJAMA,MAAMA,EAAmB,CAAC,CACxBC,KAAAA,EACAC,QAAAA,EACAC,YAAAA,EACAC,SAAAA,CAMF,IAAM,CACJ,KAAM,CAACC,CAAI,EAAIC,EAAKC,QAAS,EAGvBC,EAAmB,CACvBC,SAAU,4BAAA,EAINC,EAAgB,CACpBC,WAAYR,EAAYQ,UAAAA,EAMpBC,EAAW,MAAOC,GAAgB,CAChC,KAAA,CAAEC,QAAAA,EAASH,WAAAA,CAAeE,EAAAA,EAChC,MAAME,EAAiB,CACrBC,MAAOL,EACPG,QAAAA,EACAG,YAAad,EAAYe,MAAAA,CAC1B,EACDd,EAASO,CAAU,EACTQ,IACVC,EAAQC,QAAQ,CAAEC,QAAS,4CAAA,CAAW,CAAA,EAGlCC,EAAkBC,GAAmB,CACjCC,QAAAA,IAAI,UAAWD,CAAS,CAAA,EAM5BL,EAAW,IAAM,CACrBd,EAAKqB,YAAa,EAClBxB,EAAQ,EAAK,CAAA,EAGf,SACGyB,EAAK,CAAC,MAAM,6CAAU,KAAA1B,EAAY,OAAQ,CAAG,EAAA,WAC3CK,EAAI,CACH,KAAAD,EACA,KAAK,SACL,SAAU,CAAEuB,KAAM,CAAE,EACpB,WAAY,CAAEA,KAAM,EAAG,EACvB,SAAAhB,EACA,eAAAW,EACA,iBAAAf,EACA,gBAAiB,CAAC,SAAU,UAAU,EACtC,cAAAE,EACA,aAAa,MAAK,SAElB,CAACmB,EAAAvB,EAAK,KAAI,CACR,MAAM,iCACN,KAAK,aACL,MAAO,CACL,CAAEG,SAAU,EAAA,EACZ,CACEqB,UAAWC,EAAGC,EAAO,CAEnB,MAAI,CAACA,GADWC,EACMC,KAAKF,CAAK,EACvBG,QAAQC,UAEVD,QAAQE,OAAO,IAAIC,MAAM,0EAAc,CAAC,CACjD,EACAC,gBAAiB,QAAA,CAClB,EACD,WAEDC,EAAK,CAAC,UAAW,EAAA,CAAG,CAAA,CAAG,EAEzBX,EAAAvB,EAAK,KAAI,CAAC,MAAM,iCAAQ,KAAK,UAAU,SAAQ,GAAA,WAC7CmC,EAAY,CACX,KAAApC,EACA,UAAW,CAAC,IAAK,GAAG,EACpB,SAAWqC,GAAiBrC,EAAKsC,cAAc,UAAWD,CAAI,EAC9D,UAAU,sCAAA,CAAQ,CAAA,CAClB,EAGHb,EAAAvB,EAAK,KAAI,CAAC,WAAY,CAAEsB,KAAM,EAAG,EAAG,MAAO,CAAEgB,UAAW,OAAQ,EAAE,WAChEC,EAAK,CAAA,SAAA,CACJhB,EAACiB,EAAM,CAAC,QAAS3B,EAAS,SAAA,cAAA,CAAY,EACtCU,EAACiB,EAAM,CAAC,KAAK,UAAU,SAAS,SAAQ,SAAA,cAAA,CAE/B,CAAA,CAAA,CAAA,CAAA,CAED,CAAA,CAAA,CAAA,CAAA,CAER,CAEZ"}