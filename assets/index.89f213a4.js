import{aL as R,aE as $,r,F as i,m as S,a as s,d as O,j as u,B as p,D as V,aN as w,U as f,c3 as j}from"./index.d120665a.js";import{a as P}from"./ability.76abc61e.js";import{b as M}from"./myApp.e4b4471e.js";import{U as b}from"./UploadOutlined.4ba0689a.js";const T="_header_zn0qe_1",k="_title_zn0qe_6",G="_section_zn0qe_17",H="_guide_zn0qe_27",J="_step_zn0qe_36",K="_icon01_zn0qe_58",Q="_icon02_zn0qe_61",W="_icon03_zn0qe_64",X="_arrow_zn0qe_67",Y="_download_zn0qe_81",a={header:T,title:k,section:G,guide:H,step:J,"step-item":"_step-item_zn0qe_40","step-icon":"_step-icon_zn0qe_53",icon01:K,icon02:Q,icon03:W,arrow:X,download:Y},se=()=>{const[_]=R(),h=$(),B=_.get("clientId"),d=Number(_.get("capabilityId")),[F,C]=r.exports.useState();(!B||!d)&&h(-1),r.exports.useEffect(()=>{(async()=>{const{data:e}=await P({id:d});!e||C(e)})()},[]);const[t]=i.useForm(),I={labelCol:{span:6},wrapperCol:{span:12},autoComplete:"off"},[A,E]=r.exports.useState(),[v,N]=r.exports.useState(),[y,x]=S.useMessage(),D=e=>{const{name:o}=e,n=o.substring(o.lastIndexOf(".")+1),c=["pdf"].includes(n);return c||y.error(`\u4E0D\u652F\u6301\u4E0A\u4F20${n}\u683C\u5F0F\u6587\u4EF6`),c||f.LIST_IGNORE};let l;const g=async(e,o)=>{const n=new FormData,{file:c}=e;n.append("file",c);try{const{data:m}=await j(n),{fileName:L,url:U}=m;l={uid:e.file.uid,name:L,status:"done",url:U}}catch(m){console.log("error",m),l={uid:e.file.uid,name:e.file.name,status:"error",url:""}}finally{o?N([l]):E([l]),t.setFieldValue(o?"applyLetter":"applyFile",l.url)}},q=e=>{e?(N(void 0),t.setFieldValue("applyLetter",void 0)):(E(void 0),t.setFieldValue("applyFile",void 0))},z=async()=>{try{await t.validateFields();const e={...t.getFieldsValue(),applyFileName:A[0].name,applyLetterName:v[0].name,capabilityId:d,clientId:B};await M(e),y.success({content:"\u63D0\u4EA4\u6210\u529F",onClose:()=>h(-1)})}catch(e){console.log(e)}};return s(O,{children:[x,s("div",{className:a.header,children:[s("div",{className:a.title,children:["\u4E0A\u4F20\u7533\u8BF7\u8868 - ",F==null?void 0:F.name]}),u(p,{type:"primary",onClick:z,children:"\u63D0\u4EA4"})]}),u(V,{}),s("div",{className:a.section,children:[u("div",{className:a.guide,children:"\u64CD\u4F5C\u6307\u5F15"}),s("div",{className:a.step,children:[s("div",{className:a["step-item"],children:[u("i",{className:`${a["step-icon"]} ${a.icon01}`}),"\u4E0B\u8F7D\u7533\u8BF7\u8868"]}),u("div",{className:a.arrow}),s("div",{className:a["step-item"],children:[u("i",{className:`${a["step-icon"]} ${a.icon02}`}),"\u7EBF\u4E0B\u5370\u7AE0"]}),u("div",{className:a.arrow}),s("div",{className:a["step-item"],children:[u("i",{className:`${a["step-icon"]} ${a.icon03}`}),"\u4E0A\u4F20\u626B\u63CF\u4EF6"]})]})]}),u("div",{className:a.section,children:s(i,{form:t,name:"uploadForm",...I,children:[u(i.Item,{label:"\u7533\u8BF7\u8868\u4E0B\u8F7D\uFF1A",children:s("div",{className:"flex",children:["\u300A\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u8868.pdf\u300B",s("div",{className:a.download,children:[u(w,{}),"\u4E0B\u8F7D"]})]})}),u(i.Item,{label:"\u7533\u8BF7\u51FD\u4E0B\u8F7D\uFF1A",children:s("div",{className:"flex",children:["\u300A\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u51FD.pdf\u300B",s("div",{className:a.download,children:[u(w,{}),"\u4E0B\u8F7D"]})]})}),u(i.Item,{name:"applyFile",label:"\uFF08\u9644\u5370\u7AE0\uFF09\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u8868\uFF1A",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u7533\u8BF7\u8868"}],children:u(f,{maxCount:1,fileList:A,beforeUpload:e=>D(e),customRequest:e=>g(e,0),onRemove:()=>q(0),children:u(p,{icon:u(b,{}),children:"\u4E0A\u4F20\u6587\u4EF6"})})}),u(i.Item,{name:"applyLetter",label:"\uFF08\u9644\u5370\u7AE0\uFF09\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u51FD\uFF1A",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u7533\u8BF7\u8868"}],children:u(f,{maxCount:1,fileList:v,beforeUpload:e=>D(e),customRequest:e=>g(e,1),onRemove:()=>q(1),children:u(p,{icon:u(b,{}),children:"\u4E0A\u4F20\u6587\u4EF6"})})})]})})]})};export{se as default};
