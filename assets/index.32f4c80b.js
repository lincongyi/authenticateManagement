import{b4 as R,aI as $,r,F as i,m as S,a as s,d as j,j as u,B as m,b6 as D,U as p,c2 as O}from"./index.4ac89328.js";import{a as V}from"./ability.02132d26.js";import{b as P}from"./myApp.f13f323f.js";import{D as M}from"./index.12b0fbb3.js";import{U as q}from"./UploadOutlined.b19dddae.js";const T="_header_zn0qe_1",k="_title_zn0qe_6",G="_section_zn0qe_17",H="_guide_zn0qe_27",J="_step_zn0qe_36",K="_icon01_zn0qe_58",Q="_icon02_zn0qe_61",W="_icon03_zn0qe_64",X="_arrow_zn0qe_67",Y="_download_zn0qe_81",a={header:T,title:k,section:G,guide:H,step:J,"step-item":"_step-item_zn0qe_40","step-icon":"_step-icon_zn0qe_53",icon01:K,icon02:Q,icon03:W,arrow:X,download:Y},te=()=>{const[f]=R(),w=$(),b=f.get("clientId"),_=Number(f.get("capabilityId")),[d,C]=r.exports.useState();r.exports.useEffect(()=>{(async()=>{const{data:e}=await V({id:_});!e||C(e)})()},[]);const[t]=i.useForm(),I={labelCol:{span:6},wrapperCol:{span:12},autoComplete:"off"},[h,B]=r.exports.useState(),[A,v]=r.exports.useState(),[E,x]=S.useMessage(),N=e=>{const{name:l}=e,n=l.substring(l.lastIndexOf(".")+1),c=["doc","docx","pdf","png","jpg"].includes(n);return c||E.error(`\u4E0D\u652F\u6301\u4E0A\u4F20${n}\u683C\u5F0F\u6587\u4EF6`),c||p.LIST_IGNORE};let o;const g=async(e,l)=>{const n=new FormData,{file:c}=e;n.append("file",c);try{const{data:F}=await O(n),{fileName:L,url:U}=F;o={uid:e.file.uid,name:L,status:"done",url:U}}catch(F){console.log("error",F),o={uid:e.file.uid,name:e.file.name,status:"error",url:""}}finally{l?v([o]):B([o]),t.setFieldValue(l?"applyLetter":"applyFile",o.url)}},y=e=>{e?(v(void 0),t.setFieldValue("applyLetter",void 0)):(B(void 0),t.setFieldValue("applyFile",void 0))},z=async()=>{try{await t.validateFields();const e={...t.getFieldsValue(),applyFileName:h[0].name,applyLetterName:A[0].name,capabilityId:_,clientId:b};await P(e),E.success({content:"\u63D0\u4EA4\u6210\u529F",onClose:()=>w(-1)})}catch(e){console.log(e)}};return s(j,{children:[x,s("div",{className:a.header,children:[s("div",{className:a.title,children:["\u4E0A\u4F20\u7533\u8BF7\u8868 - ",d==null?void 0:d.name]}),u(m,{type:"primary",onClick:z,children:"\u63D0\u4EA4"})]}),u(M,{}),s("div",{className:a.section,children:[u("div",{className:a.guide,children:"\u64CD\u4F5C\u6307\u5F15"}),s("div",{className:a.step,children:[s("div",{className:a["step-item"],children:[u("i",{className:`${a["step-icon"]} ${a.icon01}`}),"\u4E0B\u8F7D\u7533\u8BF7\u8868"]}),u("div",{className:a.arrow}),s("div",{className:a["step-item"],children:[u("i",{className:`${a["step-icon"]} ${a.icon02}`}),"\u7EBF\u4E0B\u5370\u7AE0"]}),u("div",{className:a.arrow}),s("div",{className:a["step-item"],children:[u("i",{className:`${a["step-icon"]} ${a.icon03}`}),"\u4E0A\u4F20\u626B\u63CF\u4EF6"]})]})]}),u("div",{className:a.section,children:s(i,{form:t,name:"uploadForm",...I,children:[u(i.Item,{label:"\u7533\u8BF7\u8868\u4E0B\u8F7D\uFF1A",children:s("div",{className:"flex",children:["\u300A\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u8868.pdf\u300B",s("div",{className:a.download,children:[u(D,{}),"\u4E0B\u8F7D"]})]})}),u(i.Item,{label:"\u7533\u8BF7\u51FD\u4E0B\u8F7D\uFF1A",children:s("div",{className:"flex",children:["\u300A\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u51FD.pdf\u300B",s("div",{className:a.download,children:[u(D,{}),"\u4E0B\u8F7D"]})]})}),u(i.Item,{name:"applyFile",label:"\uFF08\u9644\u5370\u7AE0\uFF09\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u8868\uFF1A",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u7533\u8BF7\u8868"}],children:u(p,{maxCount:1,fileList:h,beforeUpload:e=>N(e),customRequest:e=>g(e,0),onRemove:()=>y(0),children:u(m,{icon:u(q,{}),children:"\u4E0A\u4F20\u6587\u4EF6"})})}),u(i.Item,{name:"applyLetter",label:"\uFF08\u9644\u5370\u7AE0\uFF09\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u51FD\uFF1A",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u7533\u8BF7\u8868"}],children:u(p,{maxCount:1,fileList:A,beforeUpload:e=>N(e),customRequest:e=>g(e,1),onRemove:()=>y(1),children:u(m,{icon:u(q,{}),children:"\u4E0A\u4F20\u6587\u4EF6"})})})]})})]})};export{te as default};
