import{b4 as R,aI as $,r,F as i,m as S,a as s,d as j,j as u,B as p,b6 as w,U as f,c2 as O}from"./index.f6c89b72.js";import{a as V}from"./ability.76dfe919.js";import{b as P}from"./myApp.39a1270b.js";import{D as M}from"./index.76975e45.js";import{U as b}from"./UploadOutlined.43eac959.js";const T="_header_zn0qe_1",k="_title_zn0qe_6",G="_section_zn0qe_17",H="_guide_zn0qe_27",J="_step_zn0qe_36",K="_icon01_zn0qe_58",Q="_icon02_zn0qe_61",W="_icon03_zn0qe_64",X="_arrow_zn0qe_67",Y="_download_zn0qe_81",a={header:T,title:k,section:G,guide:H,step:J,"step-item":"_step-item_zn0qe_40","step-icon":"_step-icon_zn0qe_53",icon01:K,icon02:Q,icon03:W,arrow:X,download:Y},te=()=>{const[_]=R(),h=$(),B=_.get("clientId"),d=Number(_.get("capabilityId")),[F,C]=r.exports.useState();(!B||!d)&&h(-1),r.exports.useEffect(()=>{(async()=>{const{data:e}=await V({id:d});!e||C(e)})()},[]);const[t]=i.useForm(),I={labelCol:{span:6},wrapperCol:{span:12},autoComplete:"off"},[A,v]=r.exports.useState(),[E,N]=r.exports.useState(),[g,x]=S.useMessage(),y=e=>{const{name:l}=e,n=l.substring(l.lastIndexOf(".")+1),c=["doc","docx","pdf","png","jpg"].includes(n);return c||g.error(`\u4E0D\u652F\u6301\u4E0A\u4F20${n}\u683C\u5F0F\u6587\u4EF6`),c||f.LIST_IGNORE};let o;const D=async(e,l)=>{const n=new FormData,{file:c}=e;n.append("file",c);try{const{data:m}=await O(n),{fileName:L,url:U}=m;o={uid:e.file.uid,name:L,status:"done",url:U}}catch(m){console.log("error",m),o={uid:e.file.uid,name:e.file.name,status:"error",url:""}}finally{l?N([o]):v([o]),t.setFieldValue(l?"applyLetter":"applyFile",o.url)}},q=e=>{e?(N(void 0),t.setFieldValue("applyLetter",void 0)):(v(void 0),t.setFieldValue("applyFile",void 0))},z=async()=>{try{await t.validateFields();const e={...t.getFieldsValue(),applyFileName:A[0].name,applyLetterName:E[0].name,capabilityId:d,clientId:B};await P(e),g.success({content:"\u63D0\u4EA4\u6210\u529F",onClose:()=>h(-1)})}catch(e){console.log(e)}};return s(j,{children:[x,s("div",{className:a.header,children:[s("div",{className:a.title,children:["\u4E0A\u4F20\u7533\u8BF7\u8868 - ",F==null?void 0:F.name]}),u(p,{type:"primary",onClick:z,children:"\u63D0\u4EA4"})]}),u(M,{}),s("div",{className:a.section,children:[u("div",{className:a.guide,children:"\u64CD\u4F5C\u6307\u5F15"}),s("div",{className:a.step,children:[s("div",{className:a["step-item"],children:[u("i",{className:`${a["step-icon"]} ${a.icon01}`}),"\u4E0B\u8F7D\u7533\u8BF7\u8868"]}),u("div",{className:a.arrow}),s("div",{className:a["step-item"],children:[u("i",{className:`${a["step-icon"]} ${a.icon02}`}),"\u7EBF\u4E0B\u5370\u7AE0"]}),u("div",{className:a.arrow}),s("div",{className:a["step-item"],children:[u("i",{className:`${a["step-icon"]} ${a.icon03}`}),"\u4E0A\u4F20\u626B\u63CF\u4EF6"]})]})]}),u("div",{className:a.section,children:s(i,{form:t,name:"uploadForm",...I,children:[u(i.Item,{label:"\u7533\u8BF7\u8868\u4E0B\u8F7D\uFF1A",children:s("div",{className:"flex",children:["\u300A\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u8868.pdf\u300B",s("div",{className:a.download,children:[u(w,{}),"\u4E0B\u8F7D"]})]})}),u(i.Item,{label:"\u7533\u8BF7\u51FD\u4E0B\u8F7D\uFF1A",children:s("div",{className:"flex",children:["\u300A\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u51FD.pdf\u300B",s("div",{className:a.download,children:[u(w,{}),"\u4E0B\u8F7D"]})]})}),u(i.Item,{name:"applyFile",label:"\uFF08\u9644\u5370\u7AE0\uFF09\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u8868\uFF1A",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u7533\u8BF7\u8868"}],children:u(f,{maxCount:1,fileList:A,beforeUpload:e=>y(e),customRequest:e=>D(e,0),onRemove:()=>q(0),children:u(p,{icon:u(b,{}),children:"\u4E0A\u4F20\u6587\u4EF6"})})}),u(i.Item,{name:"applyLetter",label:"\uFF08\u9644\u5370\u7AE0\uFF09\u57FA\u7840\u80FD\u529B\u63A5\u5165\u7533\u8BF7\u51FD\uFF1A",rules:[{required:!0,message:"\u8BF7\u4E0A\u4F20\u7533\u8BF7\u8868"}],children:u(f,{maxCount:1,fileList:E,beforeUpload:e=>y(e),customRequest:e=>D(e,1),onRemove:()=>q(1),children:u(p,{icon:u(b,{}),children:"\u4E0A\u4F20\u6587\u4EF6"})})})]})})]})};export{te as default};
